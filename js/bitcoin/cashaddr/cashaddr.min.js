function poly_mod(r,n){for(var t=0,o=1,e=0,c=0;c<r.length;c++)e=t>>>3,t=(7&t)<<5|o>>>27,o=(134217727&o)<<5^r[c],0!=e&&(1&e&&(t^=152,o^=4072443489),2&e&&(t^=121,o^=3077413346),4&e&&(t^=243,o^=1046459332),8&e&&(t^=174,o^=783016616),16&e&&(t^=30,o^=1329849456));return n?[t,1^o]:0==t&&0==(1^o)}function bits5to8(r){for(var n=0,t=0,o=[],e=0;e<r.length;e++)for(n<<=5,n|=r[e],t+=5;t>7;)t-=8,o.push(n>>t&255);return o}function bits8to5(r){for(var n=0,t=0,o=[],e=0;e<r.length;e++)for(n<<=8,n|=r[e],t+=8;t>5;)t-=5,o.push(n>>t&31);return t&&o.push((n&(1<<t)-1)<<5-t),o}function base58_encode(r){for(var n=[0],t=0;t<r.length;t++){for(var o=0,e=r[t];o<n.length;o++)e+=n[o]<<8,n[o]=e%58,e=e/58|0;for(;e>0;)n.push(e%58),e=e/58|0}var c="";for(t=0;t<r.length&&0==r[t];t++)c+="1";for(t=n.length-1;t>=0;t--)c+="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"[n[t]];return c}function pk2adr(r){if(!1===r)return"";r=[r[0]?5:0].concat(r.slice(1));var n=SHA256(SHA256(r)).slice(0,4);return base58_encode(r.concat(n))}function cashaddr2pk(r){r=(""+r).toLowerCase();var n=r.indexOf(":");if(-1!=n&&(r=r.substr(n+1)),r=r.replace(/(^\s+)|(\s+$)/g,""),"q"!=r[0]&&"p"!=r[0])return!1;for(var t=[],o="qpzry9x8gf2tvdw0s3jn54khce6mua7l",e=0;e<r.length;e++)if(!((n=o.indexOf(r[e]))<0)&&(t.push(n),t.length>112))return!1;return!(t.length<42)&&(0==t[1]>>2&&(!!poly_mod([2,9,20,3,15,9,14,3,1,19,8,0].concat(t))&&(t=t.slice(0,-8),bits5to8(t))))}function pk2cashaddr(r){for(var n=bits8to5(r),t=poly_mod([2,9,20,3,15,9,14,3,1,19,8,0].concat(n).concat([0,0,0,0,0,0,0,0]),!0),o=t[0],e=t[1],c=new Array(8),a=7;a>=0;a--)c[a]=31&e,e>>>=5,e|=(31&o)<<27,o>>>=5;if(n=n.concat(c),!poly_mod([2,9,20,3,15,9,14,3,1,19,8,0].concat(n)))return!1;for(var f="bitcoincash:",a=0;a<n.length;a++)f+="qpzry9x8gf2tvdw0s3jn54khce6mua7l"[31&n[a]];return f}
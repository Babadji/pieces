function poly_mod(r){for(var n=0,e=1,t=0,o=0;o<r.length;o++)t=n>>>3,n=(7&n)<<5|e>>>27,e=(134217727&e)<<5^r[o],0!=t&&(1&t&&(n^=152,e^=4072443489),2&t&&(n^=121,e^=3077413346),4&t&&(n^=243,e^=1046459332),8&t&&(n^=174,e^=783016616),16&t&&(n^=30,e^=1329849456));return 0==n&&0==(1^e)}function bits5to8(r){for(var n=0,e=0,t=[],o=0;o<r.length;o++)for(n<<=5,n|=r[o],e+=5;e>7;)e-=8,t.push(n>>e&255);return t}function base58_encode(r){for(var n=[0],e=0;e<r.length;e++){for(var t=0,o=r[e];t<n.length;t++)o+=n[t]<<8,n[t]=o%58,o=o/58|0;for(;o>0;)n.push(o%58),o=o/58|0}var f="";for(e=0;e<r.length&&0==r[e];e++)f+="1";for(e=n.length-1;e>=0;e--)f+="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"[n[e]];return f}function pk2adr(r){if(!1===r)return"";r[0]&&(r[0]=5);var n=SHA256(SHA256(r)).slice(0,4);return base58_encode(r.concat(n))}function cashaddr2pk(r){r=(""+r).toLowerCase();var n=r.indexOf(":");if(-1!=n&&(r=r.substr(n+1)),r=r.replace(/(^\s+)|(\s+$)/g,""),"q"!=r[0]&&"p"!=r[0])return!1;for(var e=[],t="qpzry9x8gf2tvdw0s3jn54khce6mua7l",o=0;o<r.length;o++)if(!((n=t.indexOf(r[o]))<0)&&(e.push(n),e.length>112))return!1;return!(e.length<42)&&(0==e[1]>>2&&(!!poly_mod([2,9,20,3,15,9,14,3,1,19,8,0].concat(e))&&(e=e.slice(0,-8),bits5to8(e))))}